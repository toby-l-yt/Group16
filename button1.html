<!DOCTYPE html>
<html>
<head>
  <title>地點A 謎題</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=New+Tegomin:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <img
          src="https://replit.com/@tobyleeyt0118/HKYAS-Group16-project#background/background.PNG"
          class="background"
          alt="background"
          title="background"
       >
  <div class="container">
    <h1>地點A</h1>
    <div class="clue-img">
       <!-- Audio Player -->
    <audio id="myAudio" preload="auto">
      <source src="Audio/必列1.3.mp3" type="audio/mpeg">
      Your browser does not support audio playback.
    </audio>

    <button id="playButton" class="horror-button">▶️ 播放錄音</button>
    <p id="audioStatus"></p>
      
      <img
        src="clue/clue3.png">
        </div>
    <div class="clue-box">
      <p>un_____ed</p>
      <input type="text" id="answer1" placeholder="答案">
     
      <br /><br />
      <div class="clue-img">
        <img
          src="clue/clue4.png">
          </div>
      <div class="clue-box">
        <p>中文謎底</p>
        <input type="text" id="answer2" placeholder="答案">
        <p>英文謎底(全小寫)</p>
        <input type="text" id="answer3" placeholder="答案">

        <br /><br />
      <button onclick="checkAnswer()">SUBMIT</button>
      <p id="result"></p>
      <br /><br />
      <a href="index.html" class="return">回到主頁</a>
    </div>
  </div>
  <script>
          const audio = document.getElementById('myAudio');
      const playButton = document.getElementById('playButton');
      const audioStatus = document.getElementById('audioStatus');

      // 1. Set initial state
      audio.volume = 0.7;
      audio.preload = "auto"; // Preload metadata

      // 2. Handle loading progress
      audio.addEventListener('progress', () => {
        if (audio.buffered.length > 0) {
          const percentLoaded = (audio.buffered.end(0) / audio.duration * 100);
          audioStatus.textContent = `加載中... ${Math.round(percentLoaded)}%`;
        }
      });

      // 3. Timeout if audio doesn't load in 10s
      const loadTimeout = setTimeout(() => {
        if (audio.readyState < 2) { // 0-1 = not loaded
          audioStatus.textContent = "❌ 音頻加載失敗 (文件可能損壞或路徑錯誤)";
        }
      }, 10000);

      audio.addEventListener('canplay', () => {
        clearTimeout(loadTimeout);
        audioStatus.textContent = "準備就緒，點擊播放";
      });

      // 4. Reliable play button
      playButton.addEventListener('click', async () => {
        try {
          if (!audio.paused) {
            audio.pause();
            playButton.textContent = "▶️ 播放錄音";
            return;
          }

          playButton.disabled = true;
          await audio.play();
          playButton.textContent = "⏸️ 暫停錄音";
        } catch (err) {
          audioStatus.textContent = "❌ 播放失敗: " + err.message;
        } finally {
          playButton.disabled = false;
        }
      });
    
    function checkAnswer() {
  // Get values without case conversion
      const answer1 = document.getElementById("answer1").value;
      const answer2 = document.getElementById("answer2").value;
      const answer3 = document.getElementById("answer3").value;

      // Check answers (now case-sensitive)
      if (answer1.includes("mourn") && answer2.includes("幻痛遺緒") && answer3.includes("phantom sentiment"))
 
{
  document.getElementById("result").innerHTML = `
    ✅ 答案正確!
    <audio id="successAudio" preload="auto">
      <source src="Audio/必列2.2.mp3" type="audio/mpeg">
      Your browser does not support audio playback.
    </audio>
    <button onclick="document.getElementById('successAudio').play()" class="horror-button">
      ▶️ 播放錄音
    </button>
    <p id="audioStatus"></p>
  `;
  
  // Add event listener for the new button
  document.getElementById('successAudio').addEventListener('play', function() {
    document.getElementById('audioStatus').textContent = '播放中...';
  });
  
  document.getElementById('successAudio').addEventListener('pause', function() {
    document.getElementById('audioStatus').textContent = '';
  });
  
} else {
  document.getElementById("result").innerHTML = "❌ 答案錯誤";
}


  </script>
</body>
</html>
